<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36" version="29.2.7">
  <diagram name="Page-1" id="fGa45jWVR-lB70eS4gOK">
    <mxGraphModel dx="1425" dy="781" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="S-zIWP2wBjuh3QtS4d2U-9" edge="1" parent="1" source="S-zIWP2wBjuh3QtS4d2U-1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="S-zIWP2wBjuh3QtS4d2U-5" value="">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="300" y="180" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="S-zIWP2wBjuh3QtS4d2U-1" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="&lt;b&gt;bob @ x.com&lt;/b&gt;&lt;br&gt;(Thunderbird client)" vertex="1">
          <mxGeometry height="60" width="120" x="240" y="100" as="geometry" />
        </mxCell>
        <mxCell id="S-zIWP2wBjuh3QtS4d2U-10" edge="1" parent="1" source="S-zIWP2wBjuh3QtS4d2U-2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="S-zIWP2wBjuh3QtS4d2U-6" value="">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="660" y="180" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="S-zIWP2wBjuh3QtS4d2U-2" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="&lt;b&gt;x.com&lt;/b&gt; (webportal)" vertex="1">
          <mxGeometry height="60" width="120" x="600" y="100" as="geometry" />
        </mxCell>
        <mxCell id="S-zIWP2wBjuh3QtS4d2U-11" edge="1" parent="1" source="S-zIWP2wBjuh3QtS4d2U-3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="S-zIWP2wBjuh3QtS4d2U-7" value="">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1020" y="180" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="S-zIWP2wBjuh3QtS4d2U-3" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="&lt;b&gt;mfaportal.com&lt;/b&gt;&lt;br&gt;(resolved from test.test)" vertex="1">
          <mxGeometry height="60" width="120" x="960" y="100" as="geometry" />
        </mxCell>
        <mxCell id="S-zIWP2wBjuh3QtS4d2U-12" edge="1" parent="1" source="S-zIWP2wBjuh3QtS4d2U-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="S-zIWP2wBjuh3QtS4d2U-8" value="">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1380" y="180" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="S-zIWP2wBjuh3QtS4d2U-4" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="&lt;b&gt;x.com&lt;/b&gt; (mailserver)" vertex="1">
          <mxGeometry height="60" width="120" x="1320" y="100" as="geometry" />
        </mxCell>
        <mxCell id="S-zIWP2wBjuh3QtS4d2U-5" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="" vertex="1">
          <mxGeometry height="630" width="120" x="240" y="200" as="geometry" />
        </mxCell>
        <mxCell id="S-zIWP2wBjuh3QtS4d2U-6" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="" vertex="1">
          <mxGeometry height="160" width="120" x="600" y="200" as="geometry" />
        </mxCell>
        <mxCell id="S-zIWP2wBjuh3QtS4d2U-7" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="" vertex="1">
          <mxGeometry height="630" width="120" x="960" y="200" as="geometry" />
        </mxCell>
        <mxCell id="S-zIWP2wBjuh3QtS4d2U-8" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="" vertex="1">
          <mxGeometry height="630" width="120" x="1320" y="200" as="geometry" />
        </mxCell>
        <mxCell id="S-zIWP2wBjuh3QtS4d2U-14" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" value="Bob wants to login, enters bob@x.com and presses continue." vertex="1">
          <mxGeometry height="60" width="120" x="240" y="200" as="geometry" />
        </mxCell>
        <mxCell id="S-zIWP2wBjuh3QtS4d2U-15" edge="1" parent="1" source="S-zIWP2wBjuh3QtS4d2U-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=-0.03;entryY=0.188;entryDx=0;entryDy=0;entryPerimeter=0;" target="S-zIWP2wBjuh3QtS4d2U-6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="S-zIWP2wBjuh3QtS4d2U-17" connectable="0" parent="S-zIWP2wBjuh3QtS4d2U-15" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="Queries x.com for&lt;br&gt;.well-known (gets auth endpoints)" vertex="1">
          <mxGeometry relative="1" x="-0.0341" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="S-zIWP2wBjuh3QtS4d2U-18" edge="1" parent="1" source="S-zIWP2wBjuh3QtS4d2U-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.159;entryDx=0;entryDy=0;entryPerimeter=0;exitX=-0.03;exitY=0.627;exitDx=0;exitDy=0;exitPerimeter=0;" target="S-zIWP2wBjuh3QtS4d2U-5">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="S-zIWP2wBjuh3QtS4d2U-20" connectable="0" parent="S-zIWP2wBjuh3QtS4d2U-18" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="Authorization endpoints (json/xml)&lt;br&gt;pointing to test.test/x.com" vertex="1">
          <mxGeometry relative="1" x="-0.0431" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="S-zIWP2wBjuh3QtS4d2U-22" edge="1" parent="1" source="S-zIWP2wBjuh3QtS4d2U-5" style="endArrow=classic;html=1;rounded=0;exitX=0.999;exitY=0.285;exitDx=0;exitDy=0;exitPerimeter=0;entryX=-0.001;entryY=0.284;entryDx=0;entryDy=0;entryPerimeter=0;" target="S-zIWP2wBjuh3QtS4d2U-7" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="470" y="500" as="sourcePoint" />
            <mxPoint x="961" y="383" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="S-zIWP2wBjuh3QtS4d2U-24" connectable="0" parent="S-zIWP2wBjuh3QtS4d2U-22" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="Thunderbird opens window pointing to oauth.test.test,&lt;br&gt;however this resolves to oauth.mfaportal.com/x.com in local DNS." vertex="1">
          <mxGeometry relative="1" x="0.0067" y="2" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="S-zIWP2wBjuh3QtS4d2U-23" parent="1" style="rounded=0;whiteSpace=wrap;html=1;" value="" vertex="1">
          <mxGeometry height="160" width="120" x="600" y="400" as="geometry" />
        </mxCell>
        <mxCell id="S-zIWP2wBjuh3QtS4d2U-25" edge="1" parent="1" source="S-zIWP2wBjuh3QtS4d2U-7" style="endArrow=classic;html=1;rounded=0;entryX=1;entryY=0.25;entryDx=0;entryDy=0;exitX=0.003;exitY=0.381;exitDx=0;exitDy=0;exitPerimeter=0;" target="S-zIWP2wBjuh3QtS4d2U-23" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="958" y="442" as="sourcePoint" />
            <mxPoint x="880" y="490" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="S-zIWP2wBjuh3QtS4d2U-26" connectable="0" parent="S-zIWP2wBjuh3QtS4d2U-25" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="oauth.mfaportal.com redirects Bob&lt;br&gt;to x.com" vertex="1">
          <mxGeometry relative="1" x="-0.0088" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="S-zIWP2wBjuh3QtS4d2U-28" edge="1" parent="1" source="S-zIWP2wBjuh3QtS4d2U-23" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.75;exitDx=0;exitDy=0;entryX=-0.017;entryY=0.507;entryDx=0;entryDy=0;entryPerimeter=0;" target="S-zIWP2wBjuh3QtS4d2U-7" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="850" y="620" as="sourcePoint" />
            <mxPoint x="900" y="570" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="S-zIWP2wBjuh3QtS4d2U-32" connectable="0" parent="S-zIWP2wBjuh3QtS4d2U-28" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="Redirect to &lt;br&gt;oauth.mfaportal.com/?id=bob@x.com" vertex="1">
          <mxGeometry relative="1" x="0.0182" y="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="S-zIWP2wBjuh3QtS4d2U-30" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" value="Bob sees his company login page and enters his email + pass." vertex="1">
          <mxGeometry height="80" width="120" x="600" y="400" as="geometry" />
        </mxCell>
        <mxCell id="S-zIWP2wBjuh3QtS4d2U-31" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" value="x.com redirects user back to mfaportal.com" vertex="1">
          <mxGeometry height="80" width="120" x="600" y="480" as="geometry" />
        </mxCell>
        <mxCell id="S-zIWP2wBjuh3QtS4d2U-34" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" value="oauth.mfaportal.com sees bob@x.com has MFA enabled.&lt;br&gt;&lt;br&gt;Bob has to enter a 6-digit TOTP from his authenticator." vertex="1">
          <mxGeometry height="120" width="120" x="960" y="490" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
